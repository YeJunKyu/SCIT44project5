<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>사진등록</title>
    <link rel="stylesheet" th:href="@{/assets/css/main/app.css}">
    <link rel="stylesheet" th:href="@{/assets/css/pages/auth.css}">
    <link rel="shortcut icon" th:href="@{/assets/images/logo/favicon.svg}" type="image/x-icon">
    <link rel="shortcut icon" th:href="@{/assets/images/logo/favicon.png}" type="image/png">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>

        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function(e) {
                  document.getElementById('preview').src = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            } else {
                document.getElementById('preview').src = "";
            }
        }
        function refresh() {
            // 팝업 창에서 이미지 업로드 및 업데이트 로직 수행
            // (서버에 이미지 업로드 및 데이터베이스 업데이트 코드)

            // 팝업 창 닫기
            window.close();

            // 부모 창 새로 고침
            window.opener.location.reload();
        }
    </script>
</head>
<body>
<div class="main">
    <h1 class="auth-title">이미지업로드</h1>

    <form th:action="@{/member/updatePhoto}" method="post"
          enctype="multipart/form-data" onsubmit="refresh();">

        <input type="file" id="upload" name="upload" class="image-preview-filepond" accept="image/*" onchange="readURL(this);">

        <img id="preview" style="width: 200px; height: 260px;" />


        <input type="submit" value="저장">



        <input type="hidden" id="memberid" name="memberid" th:value="${#authentication.name}">
    </form>
</div>
</body>
</html>